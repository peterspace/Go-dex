"use strict";(self.webpackChunkdex_2023=self.webpackChunkdex_2023||[]).push([[382],{2382:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var a=n(4165),r=n(5861),s=n(9439),c=n(2791),i=n(4029),d=n(9601),o=n(1736),l=n(6501),u=n(9830),x=n(6856),h=n(8308),p=n(8674),f=n(757),v=n(1221),b=n(3426),m=n(135),j=n(2460),k=n(4581),y=n(7846),g=n(184),C=[{name:"Get Cash",value:1},{name:"Completed",value:2}];function w(e){e.walletAddress;var t=e.chainId,n=e.tokensGoerli,w=e.tokensMumbai,Z=(0,h.mA)(),S=(Z.address,Z.isConnected,(0,c.useState)([])),N=(0,s.Z)(S,2),P=N[0],R=N[1],I=(0,c.useState)([]),M=(0,s.Z)(I,2),T=M[0],A=M[1],F=(0,c.useState)(!1),L=(0,s.Z)(F,2),U=(L[0],L[1],(0,c.useState)()),E=(0,s.Z)(U,2),X=E[0],B=E[1],G=(0,h.mx)(),D=(0,c.useState)(""),H=(0,s.Z)(D,2),K=H[0],O=H[1],_=(0,c.useState)(""),Y=(0,s.Z)(_,2),q=(Y[0],Y[1]),z=(0,c.useState)(),J=(0,s.Z)(z,2),Q=(J[0],J[1]),V=(0,c.useState)(""),W=(0,s.Z)(V,2),$=(W[0],W[1]),ee=(0,c.useState)([]),te=(0,s.Z)(ee,2),ne=te[0],ae=te[1],re=(0,c.useState)(),se=(0,s.Z)(re,2),ce=se[0],ie=se[1],de=(0,c.useState)(!1),oe=(0,s.Z)(de,2),le=oe[0],ue=oe[1],xe=(0,c.useState)(!1),he=(0,s.Z)(xe,2),pe=he[0],fe=he[1],ve=(0,c.useState)(null),be=(0,s.Z)(ve,2),me=be[0],je=be[1];console.log({activeTrade:me});var ke=(0,c.useState)(null),ye=(0,s.Z)(ke,2),ge=ye[0],Ce=ye[1];function we(){return we=(0,r.Z)((0,a.Z)().mark((function e(){var t,n,s,c,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new i.CH(K,ne,G.data),e.t0=ce,e.next="Get Cash"===e.t0?4:"Completed"===e.t0?15:26;break;case 4:return console.info("fetching Client Get Cash transactions"),e.next=7,t.getClientsHasNotReceivedCash();case 7:return n=e.sent,e.next=10,Promise.all(n.map(function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n,r,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.formatUnits(t.CryptoPrice.toString(),"ether"),r=d.formatUnits(t.dexShare.toString(),"ether"),s={txId:t.txId.toNumber(),token:t.token,client:t.client,bank:t.bank,CryptoPrice:n,tokenDecimals:t.tokenDecimals,dexShare:r,endBlock:t.endBlock,completed:t.completed,clientPaidCrypto:t.clientPaidCrypto,bankPaidCash:t.bankPaidCash,clientReceivedCash:t.clientReceivedCash,bankReceivedCrypto:t.bankReceivedCrypto,started:t.started},e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:return s=e.sent,c=s.filter((function(e){return!1===e.clientReceivedCash})),R(c),ue(!0),e.abrupt("break",27);case 15:return console.info("fetching Client Completed transactions"),e.next=18,t.getClientsCompletedTransacts();case 18:return n=e.sent,e.next=21,Promise.all(n.map(function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n,r,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.formatUnits(t.CryptoPrice.toString(),"ether"),r=d.formatUnits(t.dexShare.toString(),"ether"),s={txId:t.txId.toNumber(),token:t.token,client:t.client,bank:t.bank,CryptoPrice:n,tokenDecimals:t.tokenDecimals,dexShare:r,endBlock:t.endBlock,completed:t.completed,clientPaidCrypto:t.clientPaidCrypto,bankPaidCash:t.bankPaidCash,clientReceivedCash:t.clientReceivedCash,bankReceivedCrypto:t.bankReceivedCrypto,started:t.started},e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 21:return s=e.sent,o=s.filter((function(e){return!0===e.bankPaidCash&&!0===e.clientReceivedCash})),A(o),fe(!0),e.abrupt("break",27);case 26:console.warn("Please choose a transaction!");case 27:console.log("client transact",n);case 28:case"end":return e.stop()}}),e)}))),we.apply(this,arguments)}function Ze(){return(Ze=(0,r.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new i.CH(K,ne,G.data),e.next=4,t.clientGetCash(null===me||void 0===me?void 0:me.txId);case 4:return n=e.sent,e.next=7,n.wait();case 7:alert("Transaction completed. You have Received the Cash!"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Upload Error"+e.t0),alert("Upload Error"+e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}return console.log({activeFee:ge}),(0,c.useEffect)((function(){le&&fe(!1),pe&&ue(!1)}),[le,pe]),(0,c.useEffect)((function(){t&&function(){try{switch(t){case 5:O(j.L),ae(j.M),Q(18),q("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),$(.1),B(n);break;case 80001:O(y.L),ae(y.M),Q(18),q("0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0"),$(.1),B(w);break;case 97:O(k.L),ae(k.M),Q(18),q("0x4fabb145d64652a948d72533023f6e7a623c7c53"),$(.1),B(n);break;case 1:O(p.L),ae(p.M),Q(18),q("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),$(.1),B(n);break;case 137:O(f.L),ae(f.M),Q(18),q("0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0"),$(.1),B(w);break;case 56:O(v.L),ae(v.M),Q(18),q("0x4fabb145d64652a948d72533023f6e7a623c7c53"),$(.1),B(n);break;case 10:O(m.L),ae(m.M),Q(18),q("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),$(.1),B(n);break;case 42161:O(b.L),ae(b.M),Q(18),q("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),$(.1),B(n);break;default:console.warn("Please choose a token!")}}catch(e){console.log(e)}}()}),[t]),(0,c.useEffect)((function(){t&&void 0!==ce&&function(){we.apply(this,arguments)}(),console.log("activeTransaction type",ce),!t&&console.warn("Connect the wallet")}),[ce]),(0,c.useEffect)((function(){me&&Ce(null===me||void 0===me?void 0:me.dexShare)}),[me]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,g.jsx)("h5",{className:"text-gray-500",children:void 0===ce?"Select Transaction Type":"Transaction Type:"}),(0,g.jsx)("div",{className:"my-3 flex flex-row gap-2 start",onChange:function(e){return ie(e.target.value)},children:C.map((function(e){return(0,g.jsxs)("label",{children:[(0,g.jsx)("input",{type:"radio",id:"tab",name:"tab",value:e.name,className:"peer sr-only"}),(0,g.jsx)("span",{className:"px-2 py-1 rounded-md cursor-pointer ".concat(e.name===ce?"bg-sky-600 text-gray-200":"bg-black/50 text-gray-200/30"," border border-transparent peer-hover:border-gray-200/30 peer-checked:bg-sky-600 peer-checked:hover:border-transparent peer-checked:text-gray-200"),children:e.name})]},e.value)}))})]}),(0,g.jsxs)("div",{className:"overflow-x-auto relative",children:[ce===C[0].name&&(0,g.jsxs)(o.X2,{children:[(0,g.jsx)(o.XK,{headArray:["Tx Id","bank","bank addr","amount","","action"]}),(0,g.jsx)(o.yO,{children:P.length>0?P.map((function(e,t){var n,a,r;return(0,g.jsx)("tr",{className:"border-b border-gray-700 bg-transparent even:bg-gray-700/30 hover:bg-gray-400/20",onClick:function(){je(e)},children:(0,g.jsx)(g.Fragment,{children:(null===e||void 0===e?void 0:e.txId)>0?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("th",{scope:"row",className:"py-4 px-6 font-medium whitespace-nowrap text-white",children:[null===e||void 0===e?void 0:e.txId," "]}),(0,g.jsx)("td",{children:null===(n=l.Z.find((function(t){return e.bank===t.address})))||void 0===n?void 0:n.name}),(0,g.jsx)("td",{children:(0,u.Z)(null===e||void 0===e?void 0:e.bank)}),(0,g.jsxs)("td",{children:[(0,g.jsx)("span",{children:null===e||void 0===e?void 0:e.CryptoPrice})," ",(0,g.jsx)("span",{children:null===(a=X.find((function(t){return(null===e||void 0===e?void 0:e.token)===t.testAddress})))||void 0===a?void 0:a.symbol})]}),(0,g.jsx)("td",{children:(0,g.jsx)("img",{src:null===(r=X.find((function(t){return(null===e||void 0===e?void 0:e.token)===t.testAddress})))||void 0===r?void 0:r.logoURI,alt:"",className:"w-[25px] h-[25px]"})}),(0,g.jsx)("td",{children:!0===(null===e||void 0===e?void 0:e.clientReceivedCash)?(0,g.jsx)("button",{type:"button",children:"Received"}):(0,g.jsx)("button",{type:"button",className:"bg-red-600 text-white cursor-pointer px-2 py-1",onClick:function(){!function(){Ze.apply(this,arguments)}()},children:"Mark as completed"})})]}):null})},t)})):le?P.length<=0&&(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{children:"No active transactions"}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{})]}):(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{children:"Fetching transaction data"}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{})]})})]}),ce===C[1].name&&(0,g.jsxs)(o.X2,{children:[(0,g.jsx)(o.XK,{headArray:["Tx Id","bank","bank addr","amount","","completed"]}),(0,g.jsx)(o.yO,{children:T.length>0?T.map((function(e,t){var n,a,r;return(0,g.jsx)("tr",{className:"border-b border-gray-700 bg-transparent even:bg-gray-700/30 hover:bg-gray-400/20",onClick:function(){je(e)},children:(0,g.jsx)(g.Fragment,{children:(null===e||void 0===e?void 0:e.txId)>0?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("th",{scope:"row",className:"py-4 px-6 font-medium whitespace-nowrap text-white",children:[null===e||void 0===e?void 0:e.txId," "]}),(0,g.jsx)("td",{children:null===(n=l.Z.find((function(t){return e.bank===t.address})))||void 0===n?void 0:n.name}),(0,g.jsx)("td",{children:(0,u.Z)(null===e||void 0===e?void 0:e.bank)}),(0,g.jsxs)("td",{children:[(0,g.jsx)("span",{children:null===e||void 0===e?void 0:e.CryptoPrice})," ",(0,g.jsx)("span",{children:null===(a=X.find((function(t){return(null===e||void 0===e?void 0:e.token)===t.testAddress})))||void 0===a?void 0:a.symbol})]}),(0,g.jsx)("td",{children:(0,g.jsx)("img",{src:null===(r=X.find((function(t){return(null===e||void 0===e?void 0:e.token)===t.testAddress})))||void 0===r?void 0:r.logoURI,alt:"",className:"w-[25px] h-[25px]"})}),(0,g.jsx)("td",{children:e.completed?(0,g.jsx)(x.smy,{}):(0,g.jsx)(x.vB0,{})})]}):null})},t)})):pe?T.length<=0&&(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{children:"No active transactions"}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{})]}):(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{children:"Fetching transaction data"}),(0,g.jsx)("td",{}),(0,g.jsx)("td",{})]})})]})]})]})}},1736:function(e,t,n){n.d(t,{X2:function(){return r},XK:function(){return s},yO:function(){return c}});n(2791);var a=n(184),r=function(e){var t=e.children;return(0,a.jsx)("table",{className:" w-full text-gray-400",children:t})},s=function(e){var t=e.headArray;return(0,a.jsx)("thead",{className:"text-xs bg-gray-700 text-gray-400 uppercase",children:(0,a.jsx)("tr",{children:t.map((function(e,t){return(0,a.jsx)("th",{scope:"col",className:"py-3 px-6",children:e},t)}))})})},c=function(e){var t=e.children;return(0,a.jsx)("tbody",{className:"text-center",children:t})}}}]);
//# sourceMappingURL=382.a163d991.chunk.js.map