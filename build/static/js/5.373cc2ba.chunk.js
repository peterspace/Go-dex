"use strict";(self.webpackChunkdex_2023=self.webpackChunkdex_2023||[]).push([[5],{5:function(e,t,a){a.r(t),a.d(t,{default:function(){return L}});var s=a(4165),n=a(5861),r=a(9439),c=a(2791),o=a(4373),i=a(8308),l=a(9601),d=a(4029),u=a(4539),x=a(3728),f=a(6631),p=a(1777),h=a(6501),b=a(5951),m=a(9491),g=a(8674),v=a(757),k=a(1221),j=a(3426),y=a(135),w=a(2460),Z=a(4581),C=a(7846),S=a(184),N=[{name:"Get Cash",val:0},{name:"Get Crypto",val:1},{name:"Cancel",val:2}];function T(e){var t=e.walletAddress,a=e.chainId,o=e.txId,l=(0,c.useState)(""),u=(0,r.Z)(l,2),x=u[0],f=u[1],p=(0,c.useState)({}),h=(0,r.Z)(p,2),b=h[0],m=h[1],T=(0,c.useState)(!1),L=(0,r.Z)(T,2),E=L[0],I=L[1],M=(0,c.useState)(""),A=(0,r.Z)(M,2),P=(A[0],A[1]),B=(0,c.useState)(""),O=(0,r.Z)(B,2),R=(O[0],O[1]),U=(0,c.useState)(""),D=(0,r.Z)(U,2),G=(D[0],D[1]),_=(0,i.mx)(),V=(0,c.useState)(""),H=(0,r.Z)(V,2),Y=H[0],F=H[1],J=(0,c.useState)([]),q=(0,r.Z)(J,2),Q=q[0],W=q[1],X=(0,c.useState)(),z=(0,r.Z)(X,2),K=(z[0],z[1]),$=(0,c.useState)(),ee=(0,r.Z)($,2),te=(ee[0],ee[1]),ae=(0,c.useState)(.1),se=(0,r.Z)(ae,2),ne=(se[0],se[1]),re=(0,c.useState)(N[0]),ce=(0,r.Z)(re,2),oe=ce[0],ie=ce[1];function le(){return le=(0,n.Z)((0,s.Z)().mark((function e(t){var a,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new d.CH(Y,Q,_.data),e.next=3,a.getExchangeVoucherForId(t);case 3:n=e.sent,console.log(n),r={txId:n.txId,token:n.token,client:n.client,bank:n.bank,CryptoPrice:n.CryptoPrice,tokenDecimals:n.tokenDecimals,dexShare:n.dexShare,endBlock:n.endBlock,completed:n.completed,clientPaidCrypto:n.clientPaidCrypto,bankPaidCash:n.bankPaidCash,clientReceivedCash:n.clientReceivedCash,bankReceivedCrypto:n.bankReceivedCrypto,started:n.started},console.log(r),m(r),I(!0),P(r.CryptoPrice),R(r.token),G(r.tokenDecimals);case 12:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}function de(){return de=(0,n.Z)((0,s.Z)().mark((function e(t){var a,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new d.CH(Y,Q,_.data),f("Transaction in progress..."),e.next=5,a.clientGetCash(t,{gasLimit:3e6});case 5:return n=e.sent,e.next=8,n.wait();case 8:alert("You have paid, please wait for the bank to confirm!"),f(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),alert("Upload Error"+e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),de.apply(this,arguments)}function ue(){return ue=(0,n.Z)((0,s.Z)().mark((function e(t){var a,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new d.CH(Y,Q,_.data),f("Transaction in progress..."),e.next=5,a.clientCancel(t,{gasLimit:3e6});case 5:return n=e.sent,e.next=8,n.wait();case 8:alert("You have cancelled the transaction, please file a dispute!"),f(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),alert("An Error occurred"+e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),ue.apply(this,arguments)}function xe(e){!function(e){de.apply(this,arguments)}(e)}function fe(e){!function(e){ue.apply(this,arguments)}(e)}return(0,c.useEffect)((function(){a&&function(){try{switch(a){case 5:F(w.L),W(w.M),K(18),te("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),ne(.1);break;case 80001:F(C.L),W(C.M),K(18),te("0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0"),ne(.1);break;case 97:F(Z.L),W(Z.M),K(18),te("0x4fabb145d64652a948d72533023f6e7a623c7c53"),ne(.1);break;case 1:F(g.L),W(g.M),K(18),te("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),ne(.1);break;case 137:F(v.L),W(v.M),K(18),te("0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0"),ne(.1);break;case 56:F(k.L),W(k.M),K(18),te("0x4fabb145d64652a948d72533023f6e7a623c7c53"),ne(.1);break;case 10:F(y.L),W(y.M),K(18),te("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),ne(.1);break;case 42161:F(j.L),W(j.M),K(18),te("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),ne(.1);break;default:console.warn("Please choose a token!")}}catch(e){console.log(e)}}()}),[a]),E||function(e){le.apply(this,arguments)}(o),(0,S.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,S.jsx)("select",{onChange:function(e){ie(e.target.value)},children:N.map((function(e,t){return(0,S.jsx)("option",{value:e.name,children:e.name},e.name)}))}),(0,S.jsxs)("div",{className:"text-xl space-y-8 text-white rounded-lg p-5",children:[(0,S.jsxs)("div",{children:["TxId: ",b.txId]}),(0,S.jsxs)("div",{children:["Amount:"," ",(0,S.jsx)("span",{className:"",children:b.CryptoPrice+"".concat(b.symbol)})]}),(0,S.jsxs)("div",{children:["Client: ",(0,S.jsx)("span",{className:"text-sm",children:b.client})]}),(0,S.jsxs)("div",{children:["Bank: ",(0,S.jsx)("span",{className:"text-sm",children:b.bank})]}),(0,S.jsxs)("div",{children:[t===b.client&&"Get Cash"===oe.name?(0,S.jsx)("button",{className:"enableEthereumButton bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm",onClick:function(){return xe(o)},children:"Get Cash"}):(0,S.jsx)("div",{className:"text-emerald-700",children:"You are not the client"}),(0,S.jsx)("div",{className:"text-green text-center mt-3",children:x})]}),(0,S.jsxs)("div",{children:[t==b.client&&"Cancel"==oe.name?(0,S.jsx)("button",{className:"enableEthereumButton bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm",onClick:function(){return fe(o)},children:"Cancel"}):(0,S.jsx)("div",{className:"text-emerald-700",children:"You are not the client"}),(0,S.jsx)("div",{className:"text-green text-center mt-3",children:x})]})]})]})}var L=function(e){var t=e.walletAddress,a=e.chainId,N=e.setNewTransaction,L=(0,c.useState)(0),E=(0,r.Z)(L,2),I=E[0],M=E[1],A=(0,c.useState)([]),P=(0,r.Z)(A,2),B=P[0],O=P[1],R=(0,c.useState)(!1),U=(0,r.Z)(R,2),D=U[0],G=U[1],_=(0,c.useState)(!1),V=(0,r.Z)(_,2),H=V[0],Y=V[1],F=(0,c.useState)(!1),J=(0,r.Z)(F,2),q=J[0],Q=J[1],W=(0,c.useState)({}),X=(0,r.Z)(W,2),z=X[0],K=X[1],$=(0,c.useState)({}),ee=(0,r.Z)($,2),te=ee[0],ae=ee[1],se=(0,c.useState)(h.Z),ne=(0,r.Z)(se,2),re=ne[0],ce=ne[1],oe=(0,c.useState)(""),ie=(0,r.Z)(oe,2),le=(ie[0],ie[1]),de=(0,c.useState)(.1),ue=(0,r.Z)(de,2),xe=(ue[0],ue[1]),fe=(0,c.useState)(""),pe=(0,r.Z)(fe,2),he=pe[0],be=pe[1],me=(0,c.useState)([]),ge=(0,r.Z)(me,2),ve=ge[0],ke=ge[1],je=(0,c.useState)(""),ye=(0,r.Z)(je,2),we=(ye[0],ye[1]),Ze=(0,c.useState)(),Ce=(0,r.Z)(Ze,2),Se=(Ce[0],Ce[1],(0,c.useState)()),Ne=(0,r.Z)(Se,2),Te=(Ne[0],Ne[1]),Le=(0,c.useState)(),Ee=(0,r.Z)(Le,2),Ie=(Ee[0],Ee[1]),Me=(0,c.useState)({status:"",message:""}),Ae=(0,r.Z)(Me,2),Pe=Ae[0],Be=Ae[1],Oe=(0,i.mx)(),Re="\n\t\tGovercity Connect >>\n\t\tTransact: Transfer\n\t\tToken: ".concat(null===z||void 0===z?void 0:z.symbol,"\n\t\tAddress: ").concat(t,"\n\t\t"),Ue=(0,i.QW)({message:Re}),De=Ue.data,Ge=Ue.signMessage;function _e(){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,n.Z)((0,s.Z)().mark((function e(){var t,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("inprogress"!==Pe.status){e.next=2;break}return e.abrupt("return");case 2:return Be({status:"inprogress",message:"Transaction in progress..."}),e.prev=3,e.next=6,He();case 6:if(!(t=e.sent).hash){e.next=15;break}return Be({status:"inprogress",message:"Approval granted."}),e.next=11,Fe();case 11:a=e.sent,console.log("cashOrder Status",a),e.next=17;break;case 15:Be({status:"error",message:"Approval declined"}),console.error("approvalErr",t);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(3),"ACTION_REJECTED"===e.t0.code?Be({status:"error",message:"User rejected transaction"}):"UNPREDICTABLE_GAS_LIMIT"===e.t0.code?Be({status:"error",message:"Error due to unpredictable gas limit"}):(Be({status:"error",message:"An error occured"}),console.error("transactionErr",e.t0));case 22:case"end":return e.stop()}}),e,null,[[3,19]])})))).apply(this,arguments)}function He(){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,n.Z)((0,s.Z)().mark((function e(){var t,a,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ge(),we(De),t=l.parseUnits(I,z.decimals.toString()).toString(),a=BigInt(t).toString(),console.info("amountStr",a),console.info("selectedToken",z),n=new d.CH(z.testAddress,u,Oe.data),e.next=9,n.approve(he.toString(),a);case 9:return r=e.sent,e.next=12,r.wait();case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(){return Je.apply(this,arguments)}function Je(){return(Je=(0,n.Z)((0,s.Z)().mark((function e(){var t,a,n,r,c,o,i,u,x,f;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("inprogress"!==Pe.status){e.next=2;break}return e.abrupt("return");case 2:return Be({status:"inprogress",message:"Transferring..."}),t=new d.CH(he,ve,Oe.data),a=l.parseUnits(I.toString(),z.decimals.toString()),n=BigInt(a).toString(),r="10000000000000000",console.info("dexShareStr",r),c=n,o="10000000000000000",i=(null===te||void 0===te?void 0:te.address).toString(),le(i),u=z.decimals.toString(),console.log("getCash"),e.prev=14,e.next=17,t.getCash(z.testAddress,i,c,o,u,r,{value:o,gasLimit:3e6});case 17:return x=e.sent,e.next=20,x.wait();case 20:return 1===(f=e.sent).status&&(Be({status:"200",message:"Transfer Successful"}),N({amount:I,selectedBank:te,token:z})),console.log("sendTransaction",f),e.abrupt("return",f);case 26:e.prev=26,e.t0=e.catch(14),"CALL_EXCEPTION"===e.t0.code?Be({status:"error",message:"An Error occurred. Please check if you have sufficient balance"}):"ACTION_REJECTED"===e.t0.code?Be({status:"error",message:"User rejected transaction"}):Be({status:"error",message:"An Error occurred."}),console.error("dexSendToken",e.t0);case 30:case"end":return e.stop()}}),e,null,[[14,26]])})))).apply(this,arguments)}function qe(){return(qe=(0,n.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((null===t||void 0===t?void 0:t.length)<=5||Number(I)<0||Object.keys(te).length<=0)){e.next=3;break}return Be({status:"309",message:"One or more required fields are empty"}),e.abrupt("return");case 3:return e.next=5,_e();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,c.useEffect)((function(){O(b.Z),K(b.Z[0])}),[]),(0,c.useEffect)((function(){if(0!==Object.keys(z).length){var e=h.Z.filter((function(e){return e.tokens.find((function(e){return e.toLowerCase().includes(z.symbol.toLowerCase())}))}));ce(e)}0!==Object.keys(te).length&&ae({})}),[z]),(0,c.useEffect)((function(){a&&function(){try{switch(a){case 5:be(w.L),ke(w.M),Te(18),Ie("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),xe(.1);break;case 80001:be(C.L),ke(C.M),Te(18),Ie("0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0"),xe(.1);break;case 97:be(Z.L),ke(Z.M),Te(18),Ie("0x4fabb145d64652a948d72533023f6e7a623c7c53"),xe(.1);break;case 1:be(g.L),ke(g.M),Te(18),Ie("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),xe(.1);break;case 137:be(v.L),ke(v.M),Te(18),Ie("0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0"),xe(.1);break;case 56:be(k.L),ke(k.M),Te(18),Ie("0x4fabb145d64652a948d72533023f6e7a623c7c53"),xe(.1);break;case 10:be(y.L),ke(y.M),Te(18),Ie("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),xe(.1);break;case 42161:be(j.L),ke(j.M),Te(18),Ie("0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc"),xe(.1);break;default:console.warn("Please choose a token!")}}catch(e){console.log(e)}}()}),[a]),(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("section",{className:"flex flex-col items-center",children:[(0,S.jsx)("section",{className:"relative mt-4",children:(0,S.jsxs)("div",{className:"flex flex-col",children:[(0,S.jsxs)("section",{className:"mt-6 flex flex-col",children:[(0,S.jsx)("span",{className:"mb-1 text-gray-600",children:"Trading "+(null===z||void 0===z?void 0:z.symbol)+" for Cash"}),(0,S.jsxs)("div",{className:"w-fit flex flex-row inputSection inputSectionColor",children:[(0,S.jsx)("input",{type:"text",className:"input",pattern:"[0-9]*.[0-9]*",placeholder:"0.0",value:I,onChange:function(e){M((function(t){return e.target.validity.valid?e.target.value:t}))}}),(0,S.jsx)("div",{className:"ml-auto mr-2",children:(0,S.jsx)(x.P6,{selectedTokenName:null===z||void 0===z?void 0:z.symbol,modalVisible:D,toggleModal:G,selectedTokenIcon:null===z||void 0===z?void 0:z.logoURI})})]}),(0,S.jsxs)("div",{className:"mt-6 text-gray-600",children:[(0,S.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,S.jsx)("span",{children:null===re||void 0===re?void 0:re.length}),(0,S.jsx)("span",{children:"Banks available"})]}),(0,S.jsx)("button",{type:"button",className:"mt-2 px-6 py-3 w-full border rounded-md\n                                                flex flex-row gap-3 cursor-pointer text-gray-400\n                                                hover:border-gray-200/50 hover:text-gray-200\n                                                ",onClick:function(){return Q(!0)},children:0!==Object.keys(te).length?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("img",{src:null===te||void 0===te?void 0:te.logoURI,alt:"bank logo",className:"w-[25px] h-[25px]"}),(0,S.jsx)("span",{children:null===te||void 0===te?void 0:te.name}),(0,S.jsx)("span",{className:"ml-auto text-xl text-success",children:(0,S.jsx)(o.Meg,{})})]}):(0,S.jsx)("span",{className:"text-center w-full",children:"Select a bank"})})]})]}),""!==Pe.status&&(0,S.jsx)("section",{className:"mt-3 px-3 py-2 w-full h-fit flex flex-row gap-6 justify-center rounded-lg\n                ".concat("200"===Pe.status?"success":"309"===Pe.status?"warn":"inprogress"===Pe.status?"info":"error","\n                            "),onClick:function(){return Be({status:"",message:""})},children:Pe.message}),(0,S.jsx)("div",{className:"mx-auto mt-6 w-fit",children:(0,S.jsx)(x.o5,{disabled:(null===t||void 0===t?void 0:t.length)<=5||Number(I)<=0||!Object.keys(te).length>0||"inprogress"===Pe.status,onClick:function(){return function(){return qe.apply(this,arguments)}()},children:"inprogress"!==Pe.status?"Proceed":(0,S.jsx)(p.Z,{})})})]})}),(0,S.jsx)(f.Z,{visible:D,setVisible:G,title:"Choose your withdraw token",children:(0,S.jsx)("div",{className:"w-[500px] h-fit max-h-[400px] overflow-y-scroll",children:(0,S.jsx)("div",{className:"grid grid-cols-3 grid-flow-row gap-8",children:null===B||void 0===B?void 0:B.map((function(e,t){return(0,S.jsx)(m.Z,{currentItem:e,selectedToken:z,setSelectedToken:K,setIsTokenModalVisible:G},t)}))})})}),(0,S.jsxs)(f.Z,{visible:q,setVisible:Q,title:"Select Bank",children:[(0,S.jsx)("ul",{className:"mt-3 px-2 py-2 max-h-[600px] h-fit flex flex-col gap-2 border border-gray-200/10 rounded-md overflow-scroll scrollbar-hide",children:re.map((function(e){return(0,S.jsxs)("li",{className:"px-6 py-3 border rounded-md\n                                                flex flex-row gap-3 cursor-pointer text-gray-400\n                                                hover:border-gray-200/50 hover:text-gray-200\n                                                ".concat((null===te||void 0===te?void 0:te.address)===e.address?"border-gray-200/50 text-gray-200 info":"border-gray-200/10 bg-black/30"),onClick:function(){return ae(e)},children:[(0,S.jsx)("img",{src:e.logoURI,alt:"bank",className:"w-[25px] h-[25px]"}),(0,S.jsx)("span",{children:e.name}),(0,S.jsx)("span",{className:"ml-auto text-xl text-success\n                                    ".concat((null===te||void 0===te?void 0:te.address)===e.address?"visible":"invisible"),children:(0,S.jsx)(o.Meg,{})})]},e.address)}))}),(0,S.jsx)("button",{type:"button",className:"mt-3 ml-auto text-white",onClick:function(){return Q(!1)},children:"Done"})]}),(0,S.jsx)(f.Z,{visible:H,setVisible:Y,hideTitle:!0,children:(0,S.jsx)(T,{walletAddress:t,chainId:a,txId:"ll"})})]})})}}}]);
//# sourceMappingURL=5.373cc2ba.chunk.js.map